# coding: utf-8
import sys, os

sys.path.append(os.pardir)  # 为了导入父目录中的文件而进行的设定
import numpy as np
from common.functions import softmax, cross_entropy_error
from common.gradient import numerical_gradient


class simpleNet:

    def __init__(self):
        self.W = np.random.randn(2, 3)
        # print("self.W:", self.W)
        # print("self.W:", self.W.shape)
        # self.W: [[-1.04357618 -0.65131361 -1.0444367 ]
        #          [ 0.45952883  1.56888704  0.180343  ]]
        # self.W: (2, 3)

    def predict(self, x):
        return np.dot(x, self.W)  # (2,) * (2, 3)

    def loss(self, x, t):
        z = self.predict(x)
        print("z:", z)
        print("z:", z.shape)

        y = softmax(z)
        print("y:", y)

        loss = cross_entropy_error(y, t)
        print("loss:", loss)

        return loss


x = np.array([0.6, 0.9])
# print("x:", x)  # x: [0.6 0.9]
print("x:", x.shape)  # x: (2,)

t = np.array([0, 0, 1])
# print("t:", t)  # t: [0 0 1]
print("t:", t.shape)  # t: (3,)

net = simpleNet()

f = lambda w: net.loss(x, t)
dW = numerical_gradient(f, net.W)

print(dW)
"""
idx: (0, 0)
z: [0.28779336 0.90612858 0.48566101]
z: (3,)
y: [0.24542064 0.45546043 0.29911894]
loss: 1.2069136717096214
z: [0.28767336 0.90612858 0.48566101]
z: (3,)
y: [0.24539841 0.45547384 0.29912774]
loss: 1.2068842225764687

idx: (0, 1)
z: [0.28773336 0.90618858 0.48566101]
z: (3,)
y: [0.24540282 0.45548202 0.29911517]
loss: 1.2069262752750927
z: [0.28773336 0.90606858 0.48566101]
z: (3,)
y: [0.24541623 0.45545225 0.29913151]
loss: 1.206871619237196

idx: (0, 2)
z: [0.28773336 0.90612858 0.48572101]
z: (3,)
y: [0.24540512 0.45545896 0.29913592]
loss: 1.2068568946015639
z: [0.28773336 0.90612858 0.48560101]
z: (3,)
y: [0.24541393 0.45547531 0.29911076]
loss: 1.2069409997725988

idx: (1, 0)
z: [0.28782336 0.90612858 0.48566101]
z: (3,)
y: [0.24542619 0.45545707 0.29911673]
loss: 1.2069210344095789
z: [0.28764336 0.90612858 0.48566101]
z: (3,)
y: [0.24539286 0.45547719 0.29912995]
loss: 1.2068768607098372

idx: (1, 1)
z: [0.28773336 0.90621858 0.48566101]
z: (3,)
y: [0.24539947 0.45548946 0.29911108]
loss: 1.206939939842606
z: [0.28773336 0.90603858 0.48566101]
z: (3,)
y: [0.24541958 0.45544481 0.2991356 ]
loss: 1.206857955785758

idx: (1, 2)
z: [0.28773336 0.90612858 0.48575101]
z: (3,)
y: [0.24540292 0.45545487 0.29914221]
loss: 1.2068358687805196
z: [0.28773336 0.90612858 0.48557101]
z: (3,)
y: [0.24541613 0.4554794  0.29910447]
loss: 1.2069620265370604

[[ 0.14724567  0.27328019 -0.42052586]
 [ 0.2208685   0.40992028 -0.63078878]]
"""
